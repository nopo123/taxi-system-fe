import{i as b,f as I,R as h,h as y,r as C,j as a,L as S,k as l}from"./index-Bn22ju4j.js";import{c as w,a as i,d as k,u as B}from"./formik.esm-DcbXOIxt.js";import{U as T}from"./UserService-DBYmU35t.js";import{O as F}from"./OrganizationService-CHfxAHZE.js";import{C as W}from"./Container-Bx1Kr23n.js";import{B as c,T as q}from"./Box-9N2gnsen.js";import{B as p}from"./Button-D1XRG8Gg.js";import{T as s,F as g,S as f}from"./TextField-a0JGo00p.js";import{I as x,F as v}from"./OutlinedInput-1Wh2PjgD.js";import{M as m}from"./MenuItem-BCkBawk2.js";import"./useThemeProps-DcV2iQdr.js";import"./useControlled-Di7wUfld.js";import"./Popover-yJMaAJO1.js";import"./ownerWindow-DvT1GKkC.js";import"./useTheme-Y9mmvfV8.js";import"./createSvgIcon-CQDQQGMN.js";import"./listItemTextClasses-CaWsKo2K.js";const R=w({firstName:i().required("Krsnté meno je povinné").min(2,"Krstné meno musí mať aspoň 2 znaky"),lastName:i().required("Priezvisko je povinné").min(2,"Priezvisko musí mať aspoň 2 znaky"),email:i().email("Nepovolený formát emailu").required("Email je povinný"),password:i().required("Heslo je povinné").min(4,"Heslo musí mať aspoň 4 znakov"),role:i().required("Rola je povinná"),organizationId:k().required("Spoločnosť je povinná")}),X=()=>{const{user:n}=b(),{enqueueSnackbar:t}=I(),[j,z]=h.useState([]),d=y(),[N,u]=h.useState(!1),e=B({initialValues:{firstName:"",lastName:"",email:"",password:"",role:"",organizationId:n.organizationId?n.organizationId:""},validationSchema:R,onSubmit:async r=>{try{const o={firstName:r.firstName,lastName:r.lastName,email:r.email,password:r.password,role:r.role,organizationId:r.organizationId};await T.createUser(o),t("Vytvorenie používateľa prebehlo úspešne",{variant:"success"}),d("/dashboard/users")}catch(o){t(o.response.data.message,{variant:"error"})}}});return C.useEffect(()=>{u(!0),(async()=>{try{if(!n.organizationId&&n.role!==l.super_admin)return;if(n.role===l.super_admin){const o=await F.getAll();z(o),e.setFieldValue("organizationId",o[0].id);return}}catch(o){t(o.response.data.message,{variant:"error"})}})(),u(!1)},[n]),a.jsx(a.Fragment,{children:N?a.jsx(S,{}):a.jsx(W,{maxWidth:"sm",children:a.jsxs(c,{sx:{marginTop:4,textAlign:"center"},children:[a.jsxs("div",{children:[a.jsx(q,{variant:"h4",gutterBottom:!0,children:"Vytvorenie používateľa"}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx(p,{onClick:()=>d("/dashboard/users"),color:"primary",variant:"contained",children:"Späť"})})]}),a.jsxs("form",{onSubmit:e.handleSubmit,children:[a.jsx(s,{fullWidth:!0,margin:"normal",id:"firstName",name:"firstName",label:"Krstné meno",value:e.values.firstName,onChange:e.handleChange,error:e.touched.firstName&&!!e.errors.firstName,helperText:e.touched.firstName&&e.errors.firstName}),a.jsx(s,{fullWidth:!0,margin:"normal",id:"lastName",name:"lastName",label:"Priezvisko",value:e.values.lastName,onChange:e.handleChange,error:e.touched.lastName&&!!e.errors.lastName,helperText:e.touched.lastName&&e.errors.lastName}),a.jsx(s,{fullWidth:!0,margin:"normal",id:"email",name:"email",label:"Email",type:"email",value:e.values.email,onChange:e.handleChange,error:e.touched.email&&!!e.errors.email,helperText:e.touched.email&&e.errors.email}),a.jsx(s,{fullWidth:!0,margin:"normal",id:"password",name:"password",label:"Heslo",type:"password",value:e.values.password,onChange:e.handleChange,error:e.touched.password&&!!e.errors.password,helperText:e.touched.password&&e.errors.password}),n.role===l.super_admin&&a.jsxs(g,{fullWidth:!0,margin:"normal",error:e.touched.organizationId&&!!e.errors.organizationId,children:[a.jsx(x,{id:"organization-label",children:"Spoločnosť"}),a.jsx(f,{labelId:"organization-label",id:"organizationId",name:"organizationId",value:e.values.organizationId,onChange:e.handleChange,label:"Spoločnosť",children:j.map(r=>a.jsx(m,{value:r.id,children:r.name},r.id))}),a.jsx(v,{children:e.touched.organizationId&&e.errors.organizationId})]}),a.jsxs(g,{fullWidth:!0,margin:"normal",error:e.touched.role&&!!e.errors.role,children:[a.jsx(x,{id:"role-label",children:"Rola"}),a.jsxs(f,{labelId:"role-label",id:"role",name:"role",value:e.values.role,onChange:e.handleChange,label:"Rola",children:[a.jsx(m,{value:"user",children:"Zamestnanec"}),a.jsx(m,{value:"admin",children:"Manažér"})]}),a.jsx(v,{children:e.touched.role&&e.errors.role})]}),a.jsx(c,{sx:{mt:2},children:a.jsx(p,{color:"primary",variant:"contained",fullWidth:!0,type:"submit",children:"Vytvoriť Používateľa"})})]})]})})})};export{X as default};
